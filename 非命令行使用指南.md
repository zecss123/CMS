# CMS振动分析系统 - 非命令行使用指南

本指南介绍如何在不使用命令行的情况下使用CMS振动分析系统。

## 🚀 快速开始

### 方式1: 离线演示版本（推荐新手）

**特点**: 无需网络连接，使用模拟数据，功能完整

```bash
# 直接运行离线演示
python cms_offline_demo.py
```

**功能演示**:
- ✅ 振动数据分析（模拟数据）
- ✅ 文本嵌入向量生成
- ✅ 智能对话系统
- ✅ 完整的分析报告生成

### 方式2: 交互式启动脚本

**特点**: 提供菜单选择，支持真实API调用

```bash
# 交互式菜单
python run_cms_direct.py

# 或者运行演示
python run_cms_direct.py --demo
```

### 方式3: 直接函数调用

**特点**: 适合程序员，可以直接在Python代码中调用

```python
# 导入函数
from cms_offline_demo import demo_analyze_vibration, demo_get_embedding, demo_chat

# 分析振动数据
result = demo_analyze_vibration(region="A08", station="1003", position="8", point="AI_CMS024", hours=24)
print(result["report"])

# 生成文本嵌入向量
embedding = demo_get_embedding("这是测试文本")
print(f"向量维度: {len(embedding)}")

# 智能对话
response = demo_chat("什么是振动分析？")
print(response)
```

### 方式4: Web界面版本

**特点**: 图形化界面，易于使用

```bash
# Gradio网页界面
python gradio_app_complete_final.py
# 然后在浏览器中打开显示的URL

# Streamlit交互式应用
streamlit run streamlit_app.py
# 然后在浏览器中打开显示的URL
```

## 📊 功能对比

| 版本 | 网络要求 | 数据类型 | 适用场景 | 难度 |
|------|----------|----------|----------|------|
| 离线演示版 | ❌ 无需网络 | 模拟数据 | 学习、演示 | ⭐ 简单 |
| 交互式脚本 | ✅ 需要网络 | 真实数据 | 日常使用 | ⭐⭐ 中等 |
| 直接函数调用 | ❌ 无需网络 | 模拟数据 | 开发集成 | ⭐⭐⭐ 高级 |
| Web界面 | ✅ 需要网络 | 真实数据 | 可视化操作 | ⭐ 简单 |

## 🔧 详细使用说明

### 离线演示版本使用

1. **直接运行**:
   ```bash
   python cms_offline_demo.py
   ```

2. **在Python脚本中使用**:
   ```python
   from cms_offline_demo import get_demo_app
   
   # 获取应用实例
   app = get_demo_app()
   
   # 分析振动数据
   result = app.analyze_vibration_data(
       region="A08", station="1003", position="8", point="AI_CMS024",
       start_time="2025-01-12 00:00:00", end_time="2025-01-13 00:00:00"
   )
   
   if result["success"]:
       print(result["report"])
   ```

3. **便捷函数**:
   ```python
   from cms_offline_demo import demo_analyze_vibration, demo_get_embedding, demo_chat
   
   # 快速分析（最近24小时）
   result = demo_analyze_vibration()
   
   # 生成嵌入向量
   embedding = demo_get_embedding("测试文本")
   
   # 智能对话
   response = demo_chat("请解释RMS值的含义")
   ```

### 交互式脚本使用

1. **启动交互式菜单**:
   ```bash
   python run_cms_direct.py
   ```

2. **选择功能**:
   - 输入 `1`: 振动数据分析
   - 输入 `2`: 文本嵌入向量生成
   - 输入 `3`: 智能对话
   - 输入 `4`: 快速分析（使用默认参数）
   - 输入 `0`: 退出

3. **按提示输入参数**:
   - 区域、风场、位置、测点
   - 时间范围选择
   - 是否保存结果

### 直接函数调用使用

适合在其他Python程序中集成CMS功能:

```python
# 方式1: 使用离线演示版本
from cms_offline_demo import demo_analyze_vibration

def my_analysis_function():
    result = demo_analyze_vibration(region="A08", station="1003")
    return result["report"]

# 方式2: 使用完整版本（需要网络）
from cms_direct_app import analyze_vibration

def my_real_analysis():
    result = analyze_vibration(
        region="A08", station="1003", position="8", point="AI_CMS024",
        start_time="2025-01-12 00:00:00", end_time="2025-01-13 00:00:00"
    )
    return result
```

## 📁 输出文件说明

### 分析报告文件
- **格式**: `.txt` 文本文件
- **命名**: `demo_report_YYYYMMDD_HHMMSS.txt`
- **内容**: 完整的振动分析报告

### 图表文件
- **格式**: `.png` 图片文件（真实API）或 `.txt` 文本文件（演示模式）
- **命名**: `chart_YYYYMMDD_HHMMSS.png`
- **内容**: 振动数据可视化图表

### 嵌入向量文件
- **格式**: `.txt` 文本文件
- **命名**: `embedding_YYYYMMDD_HHMMSS.txt`
- **内容**: 文本和对应的1024维向量

## 🛠️ 故障排除

### 常见问题

1. **网络连接超时**
   - 问题: `Connection timeout`
   - 解决: 使用离线演示版本 `cms_offline_demo.py`

2. **模块导入失败**
   - 问题: `ImportError` 或 `ModuleNotFoundError`
   - 解决: 确保在项目根目录运行，或使用绝对路径

3. **权限错误**
   - 问题: 无法创建文件
   - 解决: 检查目录写入权限

### 调试模式

启用详细日志:
```python
from loguru import logger
logger.add("debug.log", level="DEBUG")
```

## 🎯 使用建议

### 新手用户
1. 先运行 `cms_offline_demo.py` 了解系统功能
2. 尝试 `run_cms_direct.py` 的交互式菜单
3. 最后使用Web界面进行日常操作

### 开发者
1. 研究 `cms_offline_demo.py` 的函数接口
2. 参考 `cms_direct_app.py` 的完整实现
3. 根据需要集成到自己的项目中

### 运维人员
1. 使用Web界面进行日常监控
2. 设置定时脚本调用分析函数
3. 配置报告自动生成和发送

## 📞 技术支持

如果遇到问题，请检查:
1. Python版本 (推荐3.8+)
2. 依赖包安装情况
3. 网络连接状态
4. 文件权限设置

---

**🎉 现在您可以不使用命令行，轻松使用CMS振动分析系统了！**